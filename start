#!/bin/zsh

# Start the Gödel Judge application

echo "Starting Gödel Judge..."

# Check if port 5173 is already in use
if lsof -ti:5173 >/dev/null 2>&1; then
    echo "⚠ Port 5173 is already in use"
    echo "→ Cleaning up existing server..."

    # Kill any process using port 5173
    lsof -ti:5173 | xargs kill -9 2>/dev/null

    # Also kill any vite processes
    pkill -f "vite" 2>/dev/null

    # Remove old PID file if it exists
    rm -f .dev-server.pid

    echo "✓ Port cleared"
    sleep 1
fi

# Start the dev server in the background
npm run dev &

# Save the process ID
echo $! > .dev-server.pid

# Wait for server to be ready
echo "Waiting for server to start..."
sleep 3

# Open the browser
echo "Opening browser..."
open http://localhost:5173/

echo "✓ Gödel Judge is running at http://localhost:5173/"
echo "✓ Run './stop' to stop the server"
